---
title: "recognition_emo_reg"
output: html_document
---

```{r setup, include=FALSE}
install.packages(c("R.matlab", "stringr", "splitstackshape", "writexl", "dplyr", "tidyr", "tidyverse"))
```

## Input variables: 1)subjnum_DistractionTask.csv file (encoding phase) 2)subjnum_dataOut.mat (testing phase) file 3)stimuli_set.xlsx file(fixed values to use for all subjects. This file contains the parameters about stimuli (stimuli name, social vs unsocial, negative vs neutral).

## Data Arrangement

```{r }
distraction <- read.csv("/Users/onay9/Desktop/Internship/Nicole/test/210_DistractionTask.csv", header = TRUE) #read the encoding file
View(distraction) #just to check encoding file
test <- readMat("/Users/onay9/Desktop/Internship/Nicole/test/210_dataOut.mat") #to read matlab-test file
data = lapply(test, unlist, use.names=FALSE) #to read matlab-test file
test_mem <- as.data.frame(data) #to revise data format
View(test_mem) #just to check encoding file
stimuli <- test_mem[c(1:96),] #to arrange the columns in test file
rkn <- test_mem[c(97:192),] #to arrange the columns in test file
confidence <- test_mem[c(193:288),] #to arrange the columns in test file
source <- test_mem[c(289:384),] #to arrange the columns in test file
test_mem <- test_mem[c(97:384),] #to arrange the columns in test file
new_test_mem <- cbind(stimuli, rkn, confidence, source) #to combine the columns in test file
new_test_mem <- as.data.frame(new_test_mem) #to revise data format
new_test_mem$stimuli <- str_replace(new_test_mem$stimuli, "JPG", "jpg") #to clean test file. We need all stimuli set exactly the same as encoding file. So that we can combine them and create just one data frame 
new_distraction <- distraction[,-c(9)] #delete the variable which we do not need in encoding file
new_distraction <- distraction[-c(1:7),] #delete the rows which are trials in encoding file
new_test_mem <- as.data.frame(new_test_mem) #update the format of data frame
new_distraction <- as.data.frame(new_distraction) #update the format of data frame
new_all <- cbind(new_test_mem, new_distraction [match(new_test_mem$stimuli, new_distraction$stimuliName),]) #combine encoding and test file
new_all <- cbind(new_all, stimuli_set [match(new_all$stimuli, stimuli_set$Stimuli_set), -1, drop = FALSE]) #combine stimuli set and test&encoding file. Now we have all information about stimulus characteristics(negative vs neutral events, social vs unsocial images)
new_all <- new_all[,-c(5)] #delete the column that we do not neet
names(new_all)[names(new_all) == "imgType_2"] <- "imgType" #update the name of the columns which are duplicate
View(new_all) #just to check if everything is going fine
```

## Creating the Variables Needed to Calculate Recognition Scores

```{r }
new_all$new_old[(is.na(new_all$stimuliName))] <- "new" #if the stimulus is shown in encoding or #not. "new" shows that the respondent have first seen the stimulus in testing. 
new_all$new_old[(!is.na(new_all$stimuliName))] <- "old" #if the stimulus is shown in encoding or #not. "old" shows that the respondent have first seen the stimulus in testing. 
new_all$new_old <- as.factor(new_all$new_old) #update the vector structure/variable format
new_all$remember <- (new_all$new_old == "old")&new_all$rkn == "7" #"response" variable is including 7=remember, 8=know and 9=new. This created new vector enables us to to see the count of responses with as answered as "remember" for old stimuli. It is "old" stimuli because here we are testing the memory for encoded events.
subj_test$remember <- as.integer(subj_test$remember) #update variable structure
new_all$remember <- as.integer(new_all$remember)
new_all$know <- (new_all$new_old == "old")&new_all$rkn == "8" #This created new vector enables us to to see the count of responses with as answered as "know" for old stimuli. It is "old" stimuli because here we are testing the memory for encoded events.
new_all$know <- as.integer(new_all$know) #update variable structure
new_all$remknow <- (new_all$remember == "1") | (new_all$know == "1") #This created to see the sum of trials as answered either as "remember" or "know". Subject can select just "remember", "know" or "new". This is to remind that "response variable(7 = remember/8 = know/9 = new ) is a binary variable.
new_all$remknow <- as.integer(new_all$remknow)  #update variable structure
new_all$FA_rem <- (new_all$new_old == "new") & (new_all$rkn == "7") #this vector incicates that the subject is responsing as "remember" which actually a new stimuli (not seen in encoding part).
new_all$FA_know <- (new_all$new_old == "new") & (new_all$rkn == "8") #this vector incicates that the subject is responsing as "know" which actually a new stimuli (not seen in encoding part).
new_all$FA_rem <- as.integer(new_all$FA_rem)
new_all$FA_know<- as.integer(new_all$FA_know)
new_all$FA_total <- (new_all$FA_rem == "1") | (new_all$FA_know == "1") #here we are summing the al false alarms.
new_all$FA_total<- as.integer(new_all$FA_total)
new_all$correct_rej <- (new_all$new_old == "new") & (new_all$rkn == "9") #correct rejections mean that stimulus is new and respondent says "new" to it.
new_all$correct_rej <- as.integer(new_all$correct_rej)
new_all$miss <- (new_all$new_old == "old") & (new_all$rkn == "9") #missed trials are indicating that subject is responding as "new" to stimuli which is actually shown in encoding part.
new_all$miss <- as.integer(new_all$miss)
new_all$condition <- as.factor(new_all$condition)
new_all$imgType <- as.factor(new_all$imgType)


```

##Calculating Recognition Scores for All Stimuli

You can also embed plots, for example:

```{r pressure, echo=FALSE}
Hit_all_remknow <- sum(new_all$remknow)/length(which(new_all$new_old == "old")) #sum of all "Remember"s or "Know"s are divided by the total number of "old" stimuli
False.Alarm_remknow<- sum(new_all$FA_total)/length(which(new_all$new_old == "old")) #sum of all "False Alarm"s are divided by the total number of "old" stimuli
Correct.Rej_remknow <- sum(new_all$correct_rej)/length(which(new_all$new_old == "old")) #sum of all "Correct Rejections"s are divided by the total number of "old" stimuli
Miss_remknow <- sum(new_all$miss)/length(which(new_all$new_old == "old")) #sum of all "Miss"s are divided by the total number of "old" stimuli
Hit_rem <- sum(new_all$remember)/length(which(new_all$new_old == "old")) #sum of all "Remember"s are divided by the total number of "old" stimuli
False.Alarm_rem<- sum(new_all$FA_rem)/length(which(new_all$new_old == "old")) #sum of all "False Alarms"s for "Remember"s are divided by the total number of "old" stimuli
Hit_know<- sum(new_all$know)/length(which(new_all$new_old == "old")) #sum of all "Know"s for are divided by the total number of "old" stimuli
False.Alarm_know<- sum(new_all$FA_know)/length(which(new_all$new_old == "old")) #sum of all "False Alarm"s for "Know"s are divided by the total number of "old" stimuli
Recollection <- Hit_rem -False.Alarm_rem #Ratio of substraction of "Hit" for "Remember"s from "False Alarm"s for "Remember"s
```

#Calculating Recognition Scores for Emotional Stimuli

```{r pressure, echo=FALSE}

neg <- filter(new_all, imgType == "Negative") #We created data frame which include just "Negative" stimuli and below we do the same calculations that we did as before (refer line 67 if needed)
hit_remknow_neg <- sum(neg$remknow)/length(which(neg$new_old == "old"))
false.Alarm_remknow_neg<- sum(neg$FA_total)/length(which(neg$new_old == "old"))
correct.rej_remknow_neg <- sum(neg$correct_rej)/length(which(neg$new_old == "old"))
miss_remknow_neg <- sum(neg$miss)/length(which(neg$new_old == "old"))
hit_rem_neg <- sum(neg$remember)/length(which(neg$new_old == "old"))
false.alarm_rem_neg<- sum(neg$FA_rem)/length(which(neg$new_old == "old"))
hit_know_neg<- sum(neg$know)/length(which(neg$new_old == "old"))
recollection_neg <- hit_rem_neg -false.alarm_rem_neg
```

#Calculating Recognition Scores for Neutral Stimuli

```{r pressure, echo=FALSE}

neutral <- filter(new_all, imgType == "Neutral") #We created data frame which include just "Neutral" stimuli and below we do the same calculations that we did as before (refer line 67 if needed)
hit_remknow_neutr <- sum(neutral$remknow)/length(which(neutral$new_old == "old"))
false.Alarm_remknow_neutr<- sum(neutral$FA_total)/length(which(neutral$new_old == "old"))
correct.rej_remknow_neutr <- sum(neutral$correct_rej)/length(which(neutral$new_old == "old"))
miss_remknow_neutr <- sum(neutral$miss)/length(which(neutral$new_old == "old"))
hit_rem_neutr <- sum(neutral$remember)/length(which(neutral$new_old == "old"))
false.alarm_rem_neutr <- sum(neutral$FA_rem)/length(which(neutral$new_old == "old"))
hit_know_neutr<- sum(neutral$know)/length(which(neutral$new_old == "old"))
recollection_neutr <- hit_rem_neg -false.alarm_rem_neg
```

#Calculating Recognition Scores for Emotion Regulation Types

Here we created a data frame contaning variable with emotion regulation types. We created a variable with three levels(look, distract and reappraise conditions). Afterward, we will be able to calculate recognition scores of conditions. 

```{r pressure, echo=FALSE}

new_all$condition <- as.factor(new_all$condition)
new_all <- as.data.frame(new_all)
emo_ef_clean <- cSplit(new_all, "condition", "_")
View(emo_ef_clean)
levels(emo_ef_clean$condition_1)[c("neglook", "neulook")] <- c("look")
emo_ef_clean$condition_1 <- str_replace(emo_ef_clean$condition_1, "neglook", "look")
emo_ef_clean$condition_1 <- str_replace(emo_ef_clean$condition_1, "neulook", "look")
emo_ef_clean$condition_1 <- as.factor(emo_ef_clean$condition_1)
emo_ef_clean <- emo_ef_clean[,-c(24)]
names(emo_ef_clean)[names(emo_ef_clean) == "condition_1"] <- "emo_reg_type"
names(emo_ef_clean)[names(emo_ef_clean) == "condition_2"] <- "img_social"
```

###Calculating Recognition Scores for Look Condition for Negative Events

```{r pressure, echo=FALSE}

neg_emo_reg_look <- filter(emo_ef_clean, emo_reg_type == "look" & imgType =="Negative")
hit_remknow_look_neg <- sum(neg_emo_reg_look$remknow)/length(which(neg_emo_reg_look$new_old == "old"))
false.Alarm_remknow_look_neg<- sum(neg_emo_reg_look$FA_total)/length(which(neg_emo_reg_look$new_old == "old"))
correct.rej_remknow_look_neg <- sum(neg_emo_reg_look$correct_rej)/length(which(neg_emo_reg_look$new_old == "old"))
miss_remknow_look_neg <- sum(neg_emo_reg_look$miss)/length(which(neg_emo_reg_look$new_old == "old"))
hit_rem_look_neg <- sum(neg_emo_reg_look$remember)/length(which(neg_emo_reg_look$new_old == "old"))
false.alarm_rem_look_neg<- sum(neg_emo_reg_look$FA_rem)/length(which(neg_emo_reg_look$new_old == "old"))
hit_know_look_neg<- sum(neg_emo_reg_look$know)/length(which(neg_emo_reg_look$new_old == "old"))
recollection_look_neg <- hit_rem_look_neg -false.alarm_rem_look_neg
```

###Calculating Recognition Scores for Reappraise Condition for Negative Events

```{r pressure, echo=FALSE}

neg_emo_reg_reapp <- filter(emo_ef_clean, emo_reg_type == "reappraise" & imgType =="Negative")
hit_remknow_rapp_neg <- sum(neg_emo_reg_reapp$remknow)/length(which(neg_emo_reg_reapp$new_old == "old"))
false.Alarm_remknow_reapp_neg<- sum(neg_emo_reg_reapp$FA_total)/length(which(neg_emo_reg_reapp$new_old == "old"))
correct.rej_remknow_reapp_neg <- sum(neg_emo_reg_reapp$correct_rej)/length(which(neg_emo_reg_reapp$new_old == "old"))
miss_remknow_reapp_neg <- sum(neg_emo_reg_reapp$miss)/length(which(neg_emo_reg_reapp$new_old == "old"))
hit_rem_reapp_neg <- sum(neg_emo_reg_reapp$remember)/length(which(neg_emo_reg_reapp$new_old == "old"))
false.alarm_rem_reapp_neg<- sum(neg_emo_reg_reapp$FA_rem)/length(which(neg_emo_reg_reapp$new_old == "old"))
hit_know_reapp_neg<- sum(neg_emo_reg_reapp$know)/length(which(neg_emo_reg_reapp$new_old == "old"))
recollection_reapp_neg <- hit_rem_reapp_neg -false.alarm_rem_reapp_neg
```

###Calculating Recognition Scores for Distract Condition for Negative Events

```{r pressure, echo=FALSE}

neg_emo_reg_dist <- filter(emo_ef_clean, emo_reg_type == "distract" & imgType =="Negative")
hit_remknow_dist_neg <- sum(neg_emo_reg_dist$remknow)/length(which(neg_emo_reg_dist$new_old == "old"))
false.Alarm_remknow_dist_neg<- sum(neg_emo_reg_dist$FA_total)/length(which(neg_emo_reg_dist$new_old == "old"))
correct.rej_remknow_dist_neg <- sum(neg_emo_reg_dist$correct_rej)/length(which(neg_emo_reg_dist$new_old == "old"))
miss_remknow_dist_neg <- sum(neg_emo_reg_dist$miss)/length(which(neg_emo_reg_dist$new_old == "old"))
hit_rem_dist_neg <- sum(neg_emo_reg_dist$remember)/length(which(neg_emo_reg_dist$new_old == "old"))
false.alarm_rem_dist_neg<- sum(neg_emo_reg_dist$FA_rem)/length(which(neg_emo_reg_dist$new_old == "old"))
hit_know_dist_neg<- sum(neg_emo_reg_dist$know)/length(which(neg_emo_reg_dist$new_old == "old"))
recollection_dist_neg <- hit_rem_dist_neg -false.alarm_rem_dist_neg
```

###Calculating Recognition Scores for Look Condition for Neutral Events


```{r pressure, echo=FALSE}

neu_emo_reg_look <- filter(emo_ef_clean, emo_reg_type == "look" & imgType =="Neutral")
hit_remknow_look_neu <- sum(neu_emo_reg_look$remknow)/length(which(neu_emo_reg_look$new_old == "old"))
false.Alarm_remknow_look_neu<- sum(neu_emo_reg_look$FA_total)/length(which(neu_emo_reg_look$new_old == "old"))
correct.rej_remknow_look_neu <- sum(neu_emo_reg_look$correct_rej)/length(which(neu_emo_reg_look$new_old == "old"))
miss_remknow_look_neu <- sum(neu_emo_reg_look$miss)/length(which(neu_emo_reg_look$new_old == "old"))
hit_rem_look_neu <- sum(neu_emo_reg_look$remember)/length(which(neu_emo_reg_look$new_old == "old"))
false.alarm_rem_look_neu<- sum(neu_emo_reg_look$FA_rem)/length(which(neu_emo_reg_look$new_old == "old"))
hit_know_look_neu<- sum(neu_emo_reg_look$know)/length(which(neu_emo_reg_look$new_old == "old"))
recollection_look_neu <- hit_rem_look_neu  - false.alarm_rem_look_neu
```
###Below lines are the explanations of the variables created from line 239 to 274.
```{r pressure, echo=FALSE}
#Below calculations will cover below variables:
#Sum of "Remember" Responses for
#1)source memory is answered as "I don't know" and for correct "Remember" for all.
#2)source memory is answered as "I don't know" and for correct "Remember" for "negative" images for "look" condition.
#3)source memory is answered as "I don't know" and for correct "Remember" for "negative" images for "distract" condition.
#4)source memory is answered as "I don't know" and for correct "Remember" for "negative" images for "reappraise" condition.
#5)source memory is answered as "I don't know" and for correct "Remember" for "neutral" images.

#Sum of "Know" Responses for
#6)source memory is answered as "I don't know" and for correct "Know" for all.
#7)source memory is answered as "I don't know" and for correct "Know" for "negative" images for "look" condition.
#8)source memory is answered as "I don't know" and for correct "Know" for "negative" images for "distract" condition.
#9)source memory is answered as "I don't know" and for correct "Know" for "negative" images for "reappraise" condition.
#10)source memory is answered as "I don't know" and for correct "Know" for "neutral" images.

#Sum of "Remember or Know" Responses for
#11)source memory is answered as "I don't know" and for correct "Remember or Know" for all.
#12)source memory is answered as "I don't know" and for correct "Remember or Know" for "negative" images for "look" condition.
#13)source memory is answered as "I don't know" and for correct "Remember or Know" for "negative" images for "distract" condition.
#14)source memory is answered as "I don't know" and for correct "Remember or Know" for "negative" images for "reappraise" condition.
#15)source memory is answered as "I don't know" and for correct "Remember or Know" for "neutral" images.

#Sum of "Remember" Responses for
#16)source memory is answered as wrong and for correct "Remember" for all.
#17)source memory is answered as wrong and for correct "Remember" for "negative" images for "look" condition.
#18)source memory is answered as wrong and for correct "Remember" for "negative" images for "distract" condition.
#19)source memory is answered as wrong and for correct "Remember" for "negative" images for "reappraise" condition.
#20)source memory is answered as wrong and for correct "Remember" for "neutral" images.

#Sum of "Know" Responses for
#21)source memory is answered as wrong and for correct "Know" for all.
#22)source memory is answered as wrong and for correct "Know" for "negative" images for "look" condition.
#23)source memory is answered as wrong and for correct "Know" for "negative" images for "distract" condition.
#24)source memory is answered as wrong and for correct "Know" for "negative" images for "reappraise" condition.
#25)source memory is answered as wrong and for correct "Know" for "neutral" images.

#Sum of "Remember or Know" Responses for
#26)source memory is answered as wrong and for correct "Remember or Know" for all.
#27)source memory is answered as wrong and for correct "Remember or Know" for "negative" images for "look" condition.
#28)source memory is answered as wrong and for correct "Remember or Know" for "negative" images for "distract" condition.
#29)source memory is answered as wrong and for correct "Remember or Know" for "negative" images for "reappraise" condition.
#30)source memory is answered as wrong and for correct "Remember or Know" for "neutral" images.

one_idk_R <- sum(emo_ef_clean[which(emo_ef_clean$source== "4"&emo_ef_clean$new_old =="old"),14])
two_idk_R <- sum(emo_ef_clean[which(emo_ef_clean$source== "4"&emo_ef_clean$new_old =="old"&emo_ef_clean$mgType == "Negative"&emo_ef_clean$emo_reg_type=="look"),14])
three_idk_R <- sum(emo_ef_clean[which(emo_ef_clean$source== "4"&emo_ef_clean$new_old =="old"&emo_ef_clean$mgType == "Negative"&emo_ef_clean$emo_reg_type=="distract"),14])
four_idk_R <- sum(emo_ef_clean[which(emo_ef_clean$source== "4"&emo_ef_clean$new_old =="old"&emo_ef_clean$mgType == "Negative"&emo_ef_clean$emo_reg_type=="reappraise"),14])
five_idk_R <- sum(emo_ef_clean[which(emo_ef_clean$source== "4"&emo_ef_clean$new_old =="old"&emo_ef_clean$mgType == "Neutral"),14])

six_idk_K <- sum(emo_ef_clean[which(emo_ef_clean$source== "4"&emo_ef_clean$new_old =="old"),15])
seven_idk_K <- sum(emo_ef_clean[which(emo_ef_clean$source== "4"&emo_ef_clean$new_old =="old"&emo_ef_clean$mgType == "Negative"&emo_ef_clean$emo_reg_type=="look"),15])
eight_idk_K <- sum(emo_ef_clean[which(emo_ef_clean$source== "4"&emo_ef_clean$new_old =="old"&emo_ef_clean$mgType == "Negative"&emo_ef_clean$emo_reg_type=="distract"),15])
nine_idk_K <- sum(emo_ef_clean[which(emo_ef_clean$source== "4"&emo_ef_clean$new_old =="old"&emo_ef_clean$mgType == "Negative"&emo_ef_clean$emo_reg_type=="reappraise"),15])
ten_idk_K <- sum(emo_ef_clean[which(emo_ef_clean$source== "4"&emo_ef_clean$new_old =="old"&emo_ef_clean$mgType == "Neutral"),15])

eleven_idk_RK <- sum(emo_ef_clean[which(emo_ef_clean$source== "4"&emo_ef_clean$new_old =="old"),16])
twelve_idk_RK <- sum(emo_ef_clean[which(emo_ef_clean$source== "4"&emo_ef_clean$new_old =="old"&emo_ef_clean$mgType == "Negative"&emo_ef_clean$emo_reg_type=="look"),16])
thirteen_idk_RK <- sum(emo_ef_clean[which(emo_ef_clean$source== "4"&emo_ef_clean$new_old =="old"&emo_ef_clean$mgType == "Negative"&emo_ef_clean$emo_reg_type=="distract"),16])
fourteen_idk_RK <- sum(emo_ef_clean[which(emo_ef_clean$source== "4"&emo_ef_clean$new_old =="old"&emo_ef_clean$mgType == "Negative"&emo_ef_clean$emo_reg_type=="reappraise"),16])
fifteen_idk_RK <- sum(emo_ef_clean[which(emo_ef_clean$source== "4"&emo_ef_clean$new_old =="old"&emo_ef_clean$mgType == "Neutral"),16])

sixteen_wr_R <- sum(emo_ef_clean[which(emo_ef_clean$source== c(1:3)&emo_ef_clean$new_old =="old"&emo_ef_clean$hit_source=="0"),14])
seventeen_wr_R <- sum(emo_ef_clean[which(emo_ef_clean$source== c(1:3)&emo_ef_clean$new_old =="old"&emo_ef_clean$hit_source=="0"&emo_ef_clean$mgType == "Negative"&emo_ef_clean$emo_reg_type=="look"),14])
eighteen_wr_R <- sum(emo_ef_clean[which(emo_ef_clean$source== c(1:3)&emo_ef_clean$new_old =="old"&emo_ef_clean$hit_source=="0"&emo_ef_clean$mgType == "Negative"&emo_ef_clean$emo_reg_type=="distract"),14])
nineteen_wr_R <- sum(emo_ef_clean[which(emo_ef_clean$source== c(1:3)&emo_ef_clean$new_old =="old"&emo_ef_clean$hit_source=="0"&emo_ef_clean$mgType == "Negative"&emo_ef_clean$emo_reg_type=="reappraise"),14])
twenty_wr_R <- sum(emo_ef_clean[which(emo_ef_clean$source== c(1:3)&emo_ef_clean$new_old =="old"&emo_ef_clean$hit_source=="0"&emo_ef_clean$mgType == "Neutral"),14])

twntone_wr_K <- sum(emo_ef_clean[which(emo_ef_clean$source== c(1:3)&emo_ef_clean$new_old =="old"&emo_ef_clean$hit_source=="0"),15])
twntwo_wr_K <- sum(emo_ef_clean[which(emo_ef_clean$source== c(1:3)&emo_ef_clean$new_old =="old"&emo_ef_clean$hit_source=="0"&emo_ef_clean$mgType == "Negative"&emo_ef_clean$emo_reg_type=="look"),15])
twnthree_wr_K <- sum(emo_ef_clean[which(emo_ef_clean$source== c(1:3)&emo_ef_clean$new_old =="old"&emo_ef_clean$hit_source=="0"&emo_ef_clean$mgType == "Negative"&emo_ef_clean$emo_reg_type=="distract"),15])
twntfour_wr_K <- sum(emo_ef_clean[which(emo_ef_clean$source== c(1:3)&emo_ef_clean$new_old =="old"&emo_ef_clean$hit_source=="0"&emo_ef_clean$mgType == "Negative"&emo_ef_clean$emo_reg_type=="reappraise"),15])
twntfive_wr_K <- sum(emo_ef_clean[which(emo_ef_clean$source== c(1:3)&emo_ef_clean$new_old =="old"&emo_ef_clean$hit_source=="0"&emo_ef_clean$mgType == "Neutral"),15])

twnsix_wr_RK <- sum(emo_ef_clean[which(emo_ef_clean$source== c(1:3)&emo_ef_clean$new_old =="old"&emo_ef_clean$hit_source=="0"),16])
twntsvn_wr_RK <- sum(emo_ef_clean[which(emo_ef_clean$source== c(1:3)&emo_ef_clean$new_old =="old"&emo_ef_clean$hit_source=="0"&emo_ef_clean$mgType == "Negative"&emo_ef_clean$emo_reg_type=="look"),16])
twnteight_wr_RK <- sum(emo_ef_clean[which(emo_ef_clean$source== c(1:3)&emo_ef_clean$new_old =="old"&emo_ef_clean$hit_source=="0"&emo_ef_clean$mgType == "Negative"&emo_ef_clean$emo_reg_type=="distract"),16])
twntnine_wr_RK <- sum(emo_ef_clean[which(emo_ef_clean$source== c(1:3)&emo_ef_clean$new_old =="old"&emo_ef_clean$hit_source=="0"&emo_ef_clean$mgType == "Negative"&emo_ef_clean$emo_reg_type=="reappraise"),16])
thirty_wr_RK <- sum(emo_ef_clean[which(emo_ef_clean$source== c(1:3)&emo_ef_clean$new_old =="old"&emo_ef_clean$hit_source=="0"&emo_ef_clean$mgType == "Neutral"),16])
```



###Calculating Stars Caught in Encoding Depending on Emotion Regulation Type

Below codes, we are calculating the mean stars caught in encoding part for different conditions (look for negative events, reappraise for negative events, distract for negative events and look for neutral events, for all data, for negative events, for neutral events) 

```{r pressure, echo=FALSE}

emo_ef_clean$starsCaught <- as.numeric(emo_ef_clean$starsCaught)
neg$starsCaught <- as.numeric(neg$starsCaught)
neutral$starsCaught <- as.numeric(neutral$starsCaught)
neg_emo_reg_look$starsCaught <- as.numeric(neg_emo_reg_look$starsCaught)
neg_emo_reg_reapp$starsCaught <- as.numeric(neg_emo_reg_reapp$starsCaught)
neg_emo_reg_dist$starsCaught <- as.numeric(neg_emo_reg_dist$starsCaught)
neu_emo_reg_look$starsCaught <- as.numeric(neu_emo_reg_look$starsCaught)
mean_stars_all <- mean(emo_ef_clean$starsCaught, na.rm=TRUE)
mean_stars_neg <- mean(neg$starsCaught, na.rm = TRUE)
mean_stars_neutral <- mean(neutral$starsCaugh, na.rm = TRUE)
mean_stars_neg_emo_reg_look <- mean(neg_emo_reg_look$starsCaught, na.rm = TRUE)
mean_stars_neg_emo_reg_reapp <- mean(neg_emo_reg_reapp$starsCaught, na.rm = TRUE)
mean_stars_neg_emo_reg_dist <- mean(neg_emo_reg_dist$starsCaught, na.rm = TRUE)
mean_stars_neu_emo_reg_look <- mean(neu_emo_reg_look$starsCaught, na.rm = TRUE)
```

###Saving All of Our Calculations with New Data Frame

Let`s first combine every new variables that we have. Then this new data frame to our computer.

```{r pressure, echo=FALSE}

View(all_together)

write_xlsx(all_together, "/Users/neslihanonay/Desktop/Ulrike_internship/Data/Model/Disney/subj_number.xlsx") #two things to update: path(put your own path, and subject number)
```





